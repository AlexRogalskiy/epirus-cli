language: java
jdk:
- openjdk8
sudo: false
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: skip
test: skip
jobs:
  include:
  - stage: build master
    script: "./gradlew spotlessCheck check jacocoTestReport"
    if: branch = master OR type = pull_request
  - stage: release github
    if: branch =~ /release/
    script: "./gradlew check distZip distTar shadowDistTar shadowDistZip -Pversion=${TRAVIS_BRANCH#'release/'}
      && ./scripts/github-release.sh"
env:
  global:
  - secure: AnTzHKm0jflUeXxP9/nbFWFl3/txVJvj9YlyOU9x7RD9Vrxrc56RqUr3A7j2AP6lHJeXJD1aAp/c/Snl4ZpbCPHbjhwDEva2wCmolP/OaVxmOAwEDr4nZptokoJRgXRFy/kJEHqnRVTIvDLKnQ5uK0P/2iertanYZzPctTBBdPia/ZbJlSEaOySxFsIHkIotkFO7a5Q8lzZ0iSeMb9JCKJgZuxJHVdmDvbPCJB//la1k9OJzTqDydw/T1U43RoKdDe4xqWH9Vs87nuZ80DTEcKT8A1cZIg2PmhwF3Q/uroLVqiQ8lfxR8qoH2hyNWyNfa5dUeB3N+h7OPjNS9Tha7HY9LAUEivk2OXJhob30zu8b7C2DJJrcWgy6qs7XdO8WqnXlrlXMQFBLeMz35BcMUm+ag6g3nvAHqGeDx0QdlN7LNg1b8uavzT+olefF2ODac69W+HToEhQ1oq/kpjWU0xqyVh6y9lRU0BM4bmOSBxtYJ4LXgcE2h5LnjuV7YMF4Psh7yD6mTF+UhqAmSyJhP9KB2SpAxs1Kg7VJHH4efzJlbEJX0ad0VtEnkrKJAKIkkByboo19Avdan3ThagVZQj8OtD4kyDcAPKji+ZfPjwzBsk9Ka5u7lc9M4mGGxLe8gWdkTJtD0Rux2DfS03EmmiehVuiF29HP6wXJd/ZXBTg=
