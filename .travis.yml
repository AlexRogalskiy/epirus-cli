language: java
jdk:
- openjdk8
sudo: false
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: skip
test: skip
jobs:
  include:
  - stage: build master
    script: "./gradlew spotlessCheck check jacocoTestReport"
    if: branch = master OR type = pull_request
  - stage: release github
    if: branch =~ /release/
    script: "./gradlew check distZip distTar shadowDistTar shadowDistZip -Pversion=${TRAVIS_BRANCH#'release/'}
      && ./scripts/github-release.sh"
env:
  global:
    - secure: tR36TL5+6UrJwyG9+Uf7p95JCx+Li7thE0krVIgNgDuJ53a7gppBzIXBGd5xnMOrLAiJP0K4gKjRoRDEz/3lnAiYbmoYpX70ls/inGBuIuJ27or4B/nr0uVIYlec+Vv6Roq25pWP2doO3duBX4lYU6ZMe/MMLlatzSWV4XoOH2+vwjhgbaTKj40uQWyOJrGNjH4QD4pMxXnNFJ0M2GRTYe06loFvK9nOjCgm7xANOI/JUunY1hK/3mi0NV14rShJPPjnnxxVsJg01PD3mx3aSVRwhSpefLhxaXdhpPMF53xVtFbZnvzFVWRe3x4xEuVgH8Ty++VAodeLfbIu+JgHTp1QuN5a9pxzmZ7SAzYaghpDEJzkThWY+XS29QbRP6soR2CNMOw8MiWu/AT0AmbVB61I45cRV/YqyLTPJIUJihPKjeXrRAY2Zz6pIT8Y5ZNKxdjH8EA+w0/vmY99t3d6DeB+r/NwkBWHuw3etHJzczaAvxNGB1TsvQmYIaFjoLeXhlttz06xyTWtt8TmPikK+6XSkRUYGClxTfsPUQyFGfXxdihLVLnDUl74aitCFRZCETad9S5DIqGUI1+qa+NbmkB5bxvz66y5datrKP3UFgT+k82y1XNH4jIBPIiKetjluzLVPJ5DIz2dE9HGeAGqIOYuRj9BFu/Nzq51VvMGQ/c=